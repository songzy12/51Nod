# [算法马拉松34](http://www.51nod.com/contest/problemList.html#!contestId=49) 

## [A 范德蒙矩阵](http://www.51nod.com/contest/Problem.html#!problemId=1960&contestId=49) 

这是一道数学题，只需要将矩阵相乘后的结果写出来就可以发现：

我们最终要求的东西是 `(1+a_1+...+a_1^{n-1}) * (g_{1,1}+g_{2,1}+...+g_{n,1}) + ... +(1+a_m+...+a_m^{n-1}) * (g_{1,m}+g_{2,m}+...+g_{n,m}) `

于是我们只需要计算 `(1+a_1+...+a_1^{n-1})` 并将其进行排序，然后计算 `1+2+...+n`,  `(n+1)+...+(2n)`，再根据排序不等式，将其对应相乘便是最终的结果。

在具体的实现过程中踩到了三个坑：

1. mod p 的计算里，因为涉及到除法，所以不能直接除 (x-1)，而是通过乘 (x-1)^(p-2) 来进行计算，这是由欧拉定理保证的：n^(p-1) = 1(mod p), 从而 n^(p-2) = 1/(n) (mod p).
2. 使用等比数列的和的公式时，要注意公比不能为 1.
3. 与第 2 条类似，不仅仅是公比不为 1，而且是公比 mod p 之后不为 1.